"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var path=require("path"),fs=require("fs"),sedraParse=require("sedra-parse"),realpathAsync=function(e){return new Promise(function(r,o){fs.realpath(e,"utf8",function(e,t){e?o(e):r(t)})})},mkdirAsync=function(e){return new Promise(function(r,o){fs.mkdir(e,function(e){e&&"EEXIST"!==e.code?o(e):r()})})},readFileAsync=function(e){return new Promise(function(r,o){fs.readFile(e,"utf8",function(e,t){e?o(e):r(t)})})},writeFileAsync=function(e,r){return new Promise(function(o,t){fs.writeFile(e,r,"utf8",function(e){e?t(e):o()})})},outDir=__dirname+"/../",outSedraDir=outDir+"sedra/",throwError=function(e){throw e},readDb=function(e,r){return realpathAsync(path.join(__dirname,"../../sedra",e)).then(function(e){return readFileAsync(e).then(function(e){return r(e)}).catch(throwError)}).catch(throwError)},writeDb=function(e,r){return writeFileAsync(e,r).then(function(){realpathAsync(e).then(function(e){global.console.log("Saved '"+e+"'")}).catch(throwError)}).catch(throwError)},roots=null,lexemes=null,words=null,english=null,etymology=null,ubs=null,rootPromise=readDb("ROOTS.TXT",sedraParse.getRoots).then(function(e){roots=e}),lexemePromise=readDb("LEXEMES.TXT",sedraParse.getLexemes).then(function(e){lexemes=e}),wordPromise=readDb("WORDS.TXT",sedraParse.getWords).then(function(e){words=e}),englishPromise=readDb("ENGLISH.TXT",sedraParse.getEnglish).then(function(e){english=e}),etymologyPromise=readDb("ETIMOLGY.TXT",sedraParse.getEtymology).then(function(e){etymology=e}),ubsPromise=readDb("BFBS.TXT",sedraParse.getUbs).then(function(e){ubs=e}),convertDb=Promise.all([rootPromise,lexemePromise,wordPromise,englishPromise,etymologyPromise,ubsPromise,mkdirAsync(outSedraDir)]).then(function(){var e=""+("o="+roots)+("m="+lexemes)+("d="+words)+("n="+english)+("y="+etymology)+("u="+ubs),r=outSedraDir+"roots.js",o=outSedraDir+"lexemes.js",t=outSedraDir+"words.js",s=outSedraDir+"english.js",n=outSedraDir+"etymology.js",i=outSedraDir+"ubs.js",a=outDir+"sedrajs.esm.js",d=outDir+"sedrajs.js";return Promise.all([writeDb(r,"import{makeRoot as r}from'sedra-model';export default "+roots),writeDb(o,"import{makeLexeme as l}from'sedra-model';export default "+lexemes),writeDb(t,"import{makeWord as w}from'sedra-model';export default "+words),writeDb(s,"import{makeEnglish as e}from'sedra-model';export default "+english),writeDb(n,"import{makeEtymology as t}from'sedra-model';export default "+etymology),writeDb(i,"export default "+ubs),writeDb(a,"import{makeRoot as r,makeLexeme as l,makeWord as w,makeEnglish as e,makeEtymology as t}from'sedra-model';var o,m,d,n,y,u;"+e+"export{o as roots,m as lexemes,d as words,n as english,y as etymology,u as ubs};"),writeDb(d,"!function(g,f){'object'==typeof exports&&'undefined'!=typeof module?f(exports,require('sedra-model')):'function'==typeof define&&define.amd?define(['exports','sedra-model'],f):f(g.sedrajs={},g.sedraModel)}(this,function(x,s){'use strict';var r=s.makeRoot,l=s.makeLexeme,w=s.makeWord,e=s.makeEnglish,t=s.makeEtymology,o,m,d,n,y,u;"+e+"x.roots=o,x.lexemes=m,x.words=d,x.english=n,x.etymology=y,x.ubs=u,Object.defineProperty(x,'__esModule',{value:!0})});")])}).catch(throwError);exports.readDb=readDb,exports.writeDb=writeDb,exports.convertDb=convertDb,exports.mkDir=mkdirAsync;
